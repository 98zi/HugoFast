(self["webpackChunkvue_admin_hugo"]=self["webpackChunkvue_admin_hugo"]||[]).push([[106],{5106:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return d}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"layout"},[e("Aside"),e("div",{staticClass:"container edit"},[e("TopHeader"),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"editwrap"},[e("el-row",[e("el-col",{attrs:{span:24}},[this.id?e("a",{staticStyle:{color:"#409eff"},attrs:{href:`https://github.com/${this.githubrepo}/blob/main/content/blog/${this.id}`,target:"_blank"}},[t._v(" https://github.com/"+t._s(this.githubrepo)+" /main/content/blog/"+t._s(this.id)+" ")]):t._e()])],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[t._v("时间："),e("el-input",{attrs:{disabled:""},model:{value:t.result3.date,callback:function(e){t.$set(t.result3,"date",e)},expression:"result3.date"}})],1),e("el-col",{attrs:{span:6}},[t._v("分类："),e("el-input",{attrs:{disabled:""},model:{value:t.result4.category,callback:function(e){t.$set(t.result4,"category",e)},expression:"result4.category"}})],1),e("el-col",{attrs:{span:6}},[t._v("标签："),e("el-input",{attrs:{disabled:""},model:{value:t.result5.tags,callback:function(e){t.$set(t.result5,"tags",e)},expression:"result5.tags"}})],1),e("el-col",{attrs:{span:6}},[t._v("slug："),e("el-input",{attrs:{disabled:""},model:{value:t.result1.slug1,callback:function(e){t.$set(t.result1,"slug1",e)},expression:"result1.slug1"}})],1)],1),e("el-row",[e("el-col",{attrs:{span:24}},[t._v("标题："),e("el-input",{attrs:{disabled:""},model:{value:t.result2.title,callback:function(e){t.$set(t.result2,"title",e)},expression:"result2.title"}})],1)],1),e("el-row",[e("el-col",{attrs:{span:24}},[[e("el-input",{staticClass:"content",attrs:{type:"textarea"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})]],2)],1),e("el-row",[e("el-col",{attrs:{span:24}},[this.id?e("el-button",{attrs:{type:"primary"},on:{click:t.publishArticle}},[t._v("发布文章")]):t._e()],1)],1)],1)],1)],1)},o=[],i=n(4025),a=n(8017),s=n(6154);let u=n(9575).Base64;var c={name:"EditView",components:{Aside:i.Z,TopHeader:a.Z},data(){return{loading:!1,ghpToken:"",githubrepo:"",detailsSha:"",id:"",text:"",pattern1:/slug:\s*(.*?)\n/,result1:{slug:""},pattern2:/title:\s*(.*?)\n/,result2:{ttile:""},pattern3:/date:\s*(.*?)\n/,result3:{date:""},pattern4:/categories:\s*(.*?)\n/,result4:{category:""},pattern5:/tags:\s*(.*?)\n/,result5:{tags:""},pattern:/^---\n([\s\S]+?)\n---/,content:null,currentDate:"",base64Str:""}},methods:{findMatches(){this.id&&(this.loading=!0,s.Z.get("https://raw.githubusercontent.com/"+this.githubrepo+"/main/content/blog/"+this.id).then((t=>{this.text=t.data,this.extractMetadata()})).catch((t=>{console.error(t)})))},getDate(){const t=new Date,e=t.getFullYear(),n=t.getMonth()+1,r=t.getDate();this.currentDate=`${e}-${n}-${r}`},extractMetadata(){const t=this.text.match(this.pattern1);if(t){const e=t[1].trim();this.result1={slug1:e}}const e=this.text.match(this.pattern2);if(e){const t=e[1].trim();this.result2={title:t}}const n=this.text.match(this.pattern3);if(n){const t=n[1].trim();this.result3={date:t}}const r=this.text.match(this.pattern4);if(r){const t=r[1].trim();this.result4={category:t}}const o=this.text.match(this.pattern5);if(o){const t=o[1].trim();this.result5={tags:t}}const i=this.text.match(this.pattern);i&&(this.content=this.text.replace(i[0],"").trim()),this.loading=!1},async publishArticle(){this.loading=!0,this.getDate();const t="---\nslug: "+this.result1.slug1+"\ntitle: "+this.result2.title+"\ndate: "+this.result3.date+"\ncategories:\n  "+this.result4.category+"\ntags:\n  "+this.result5.tags+"\n---\n\n"+this.content;this.base64Str=u.encode(t),s.Z.put("https://api.github.com/repos/"+this.githubrepo+"/contents/content/blog/"+this.id,{message:"提交于 "+this.currentDate,content:this.base64Str,sha:this.detailsSha},{headers:{Accept:"application/vnd.github.v3+json",Authorization:"token "+this.ghpToken}}).then((t=>{console.log(t),this.loading=!1,this.$notify({title:"发布成功",type:"success"}),localStorage.removeItem("allData"),this.$router.push("/")})).catch((t=>{console.error(t),this.loading=!1}))}},computed:{},mounted(){this.ghpToken=localStorage.getItem("ghpToken"),this.githubrepo=localStorage.getItem("githubRepoHugoToken"),this.id=this.$route.query.name,this.detailsSha=this.$route.query.sha,this.findMatches()}},l=c,h=n(1001),f=(0,h.Z)(l,r,o,!1,null,null,null),d=f.exports},9575:function(t,e,n){(function(e,n){t.exports=n()})("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g&&n.g,(function(){"use strict";var t="3.7.5",e=t,n="function"===typeof atob,r="function"===typeof btoa,o="function"===typeof Buffer,i="function"===typeof TextDecoder?new TextDecoder:void 0,a="function"===typeof TextEncoder?new TextEncoder:void 0,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=Array.prototype.slice.call(s),c=function(t){var e={};return t.forEach((function(t,n){return e[t]=n})),e}(u),l=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,h=String.fromCharCode.bind(String),f="function"===typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(t){return new Uint8Array(Array.prototype.slice.call(t,0))},d=function(t){return t.replace(/=/g,"").replace(/[+\/]/g,(function(t){return"+"==t?"-":"_"}))},p=function(t){return t.replace(/[^A-Za-z0-9\+\/]/g,"")},g=function(t){for(var e,n,r,o,i="",a=t.length%3,s=0;s<t.length;){if((n=t.charCodeAt(s++))>255||(r=t.charCodeAt(s++))>255||(o=t.charCodeAt(s++))>255)throw new TypeError("invalid character found");e=n<<16|r<<8|o,i+=u[e>>18&63]+u[e>>12&63]+u[e>>6&63]+u[63&e]}return a?i.slice(0,a-3)+"===".substring(a):i},b=r?function(t){return btoa(t)}:o?function(t){return Buffer.from(t,"binary").toString("base64")}:g,m=o?function(t){return Buffer.from(t).toString("base64")}:function(t){for(var e=4096,n=[],r=0,o=t.length;r<o;r+=e)n.push(h.apply(null,t.subarray(r,r+e)));return b(n.join(""))},y=function(t,e){return void 0===e&&(e=!1),e?d(m(t)):m(t)},v=function(t){if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?h(192|e>>>6)+h(128|63&e):h(224|e>>>12&15)+h(128|e>>>6&63)+h(128|63&e)}e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return h(240|e>>>18&7)+h(128|e>>>12&63)+h(128|e>>>6&63)+h(128|63&e)},A=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,x=function(t){return t.replace(A,v)},C=o?function(t){return Buffer.from(t,"utf8").toString("base64")}:a?function(t){return m(a.encode(t))}:function(t){return b(x(t))},w=function(t,e){return void 0===e&&(e=!1),e?d(C(t)):C(t)},B=function(t){return w(t,!0)},S=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,_=function(t){switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return h(55296+(n>>>10))+h(56320+(1023&n));case 3:return h((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return h((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},k=function(t){return t.replace(S,_)},D=function(t){if(t=t.replace(/\s+/g,""),!l.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(3&t.length));for(var e,n,r,o="",i=0;i<t.length;)e=c[t.charAt(i++)]<<18|c[t.charAt(i++)]<<12|(n=c[t.charAt(i++)])<<6|(r=c[t.charAt(i++)]),o+=64===n?h(e>>16&255):64===r?h(e>>16&255,e>>8&255):h(e>>16&255,e>>8&255,255&e);return o},F=n?function(t){return atob(p(t))}:o?function(t){return Buffer.from(t,"base64").toString("binary")}:D,U=o?function(t){return f(Buffer.from(t,"base64"))}:function(t){return f(F(t).split("").map((function(t){return t.charCodeAt(0)})))},$=function(t){return U(Z(t))},T=o?function(t){return Buffer.from(t,"base64").toString("utf8")}:i?function(t){return i.decode(U(t))}:function(t){return k(F(t))},Z=function(t){return p(t.replace(/[-_]/g,(function(t){return"-"==t?"+":"/"})))},E=function(t){return T(Z(t))},R=function(t){if("string"!==typeof t)return!1;var e=t.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},z=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}},I=function(){var t=function(t,e){return Object.defineProperty(String.prototype,t,z(e))};t("fromBase64",(function(){return E(this)})),t("toBase64",(function(t){return w(this,t)})),t("toBase64URI",(function(){return w(this,!0)})),t("toBase64URL",(function(){return w(this,!0)})),t("toUint8Array",(function(){return $(this)}))},j=function(){var t=function(t,e){return Object.defineProperty(Uint8Array.prototype,t,z(e))};t("toBase64",(function(t){return y(this,t)})),t("toBase64URI",(function(){return y(this,!0)})),t("toBase64URL",(function(){return y(this,!0)}))},M=function(){I(),j()},O={version:t,VERSION:e,atob:F,atobPolyfill:D,btoa:b,btoaPolyfill:g,fromBase64:E,toBase64:w,encode:w,encodeURI:B,encodeURL:B,utob:x,btou:k,decode:E,isValid:R,fromUint8Array:y,toUint8Array:$,extendString:I,extendUint8Array:j,extendBuiltins:M,Base64:{}};return Object.keys(O).forEach((function(t){return O.Base64[t]=O[t]})),O}))}}]);
//# sourceMappingURL=106.a3360d2d.js.map